[2024-08-01 16:16:40,538][datasets][INFO] - PyTorch version 2.3.1 available.
[2024-08-01 16:16:40,541][datasets][INFO] - TensorFlow version 2.8.0 available.
Unfinished experiment_folder: testbergen/tmp_bioasq_pubmed_ragged_splade-v3
experiment_folder testbergen/bioasq_pubmed_ragged_splade-v3
run_name: bioasq_pubmed_ragged_splade-v3
dataset_folder: datasets/
index_folder: indexes/
runs_folder: runs/
generated_query_folder: generated_queries/
experiments_folder: testbergen
retrieve_top_k: 50
rerank_top_k: 50
generation_top_k: 5
pyserini_num_threads: 20
processing_num_proc: 40
retriever:
  init_args:
    _target_: models.retrievers.splade.Splade
    model_name: naver/splade-v3
    max_len: 512
  batch_size: 128
  batch_size_sim: 512
generator:
  init_args:
    _target_: models.generators.llm.LLM
    model_name: TinyLlama/TinyLlama-1.1B-Chat-v1.0
    max_new_tokens: 64
    max_length: 2048
    quantization: int4
    attn_implementation: sdpa
    batch_size: 1
dataset:
  dev:
    doc:
      init_args:
        _target_: modules.dataset_processor.PubMed2023_Ragged
        split: train
    query:
      init_args:
        _target_: modules.dataset_processor.BIOASQ11B_Ragged
        split: train
  test:
    doc: null
    query: null
prompt:
  system: You are a helpful assistant. Your task is to extract relevant information
    from provided documents and to answer to questions as briefly as possible.
  user: f"Background:\n{docs}\n\nQuestion:\ {question}"
  system_without_docs: You are a helpful assistant. Answer the questions as briefly
    as possible.
  user_without_docs: f"Question:\ {question}"

Processing dataset PubMed-2023_Ragged in train split 
Processing dataset BIOASQ11B_Ragged in train split 
TinyLlama/TinyLlama-1.1B-Chat-v1.0
[2024-08-01 16:17:18,115][accelerate.utils.modeling][INFO] - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).


::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
RAG Model:
Retriever: naver/splade-v3
Generator: TinyLlama/TinyLlama-1.1B-Chat-v1.0
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::


Run runs//run.retrieve.top_50.BIOASQ11B_Ragged.PubMed-2023_Ragged.dev.naver_splade-v3.trec does not exists, running retrieve...
